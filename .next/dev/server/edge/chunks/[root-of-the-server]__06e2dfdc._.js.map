{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/guards.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\n\nexport function requireSession(session: any) {\n  if (!session) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n  return null\n}\nexport function hasRole(role: string | undefined | null, allowed: string[] = []) {\n  if (!role) return false\n  return allowed.includes(role)\n}\n\nexport function requireRole(session: any, roles: string[]) {\n  const role = (session as any).user?.role\n  if (!hasRole(role, roles)) return NextResponse.json({ error: 'Forbidden' }, { status: 403 })\n  return null\n}\n\nexport function isOwner(session: any, ownerId?: string) {\n  return (session as any).user?.id === ownerId\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;;AAEO,SAAS,eAAe,OAAY;IACzC,IAAI,CAAC,SAAS,OAAO,iWAAY,CAAC,IAAI,CAAC;QAAE,OAAO;IAAe,GAAG;QAAE,QAAQ;IAAI;IAChF,OAAO;AACT;AACO,SAAS,QAAQ,IAA+B,EAAE,UAAoB,EAAE;IAC7E,IAAI,CAAC,MAAM,OAAO;IAClB,OAAO,QAAQ,QAAQ,CAAC;AAC1B;AAEO,SAAS,YAAY,OAAY,EAAE,KAAe;IACvD,MAAM,OAAO,AAAC,QAAgB,IAAI,EAAE;IACpC,IAAI,CAAC,QAAQ,MAAM,QAAQ,OAAO,iWAAY,CAAC,IAAI,CAAC;QAAE,OAAO;IAAY,GAAG;QAAE,QAAQ;IAAI;IAC1F,OAAO;AACT;AAEO,SAAS,QAAQ,OAAY,EAAE,OAAgB;IACpD,OAAO,AAAC,QAAgB,IAAI,EAAE,OAAO;AACvC"}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { withAuth } from 'next-auth/middleware'\nimport { NextResponse } from 'next/server'\n\n/**\n * Centralized middleware using next-auth's withAuth helper.\n * Protects /admin/* and /dashboard/* and redirects unauthorized users to /unauthorized.\n */\nexport default withAuth(\n  function middleware(req) {\n    const { pathname } = req.nextUrl\n  const role = String(req.nextauth?.token?.role || '')\n\n    // Admin area\n    try {\n      const { hasRole } = require('@/lib/guards')\n      if (pathname.startsWith('/dashboard/admin') && !hasRole(role, ['SUPER_ADMIN'])) {\n        return NextResponse.redirect(new URL('/unauthorized', req.url))\n      }\n\n      // Finance staff area\n      if (pathname.startsWith('/dashboard/staff/finance') && !hasRole(role, ['SUPER_ADMIN', 'FINANCE_STAFF'])) {\n        return NextResponse.redirect(new URL('/unauthorized', req.url))\n      }\n\n      // Marketplace staff area\n      if (pathname.startsWith('/dashboard/staff/marketplace') && !hasRole(role, ['SUPER_ADMIN', 'MARKETPLACE_SELLER'])) {\n        return NextResponse.redirect(new URL('/unauthorized', req.url))\n      }\n\n      // Real-estate staff area\n      if (pathname.startsWith('/dashboard/staff/real-estate') && !hasRole(role, ['SUPER_ADMIN', 'REALTOR'])) {\n        return NextResponse.redirect(new URL('/unauthorized', req.url))\n      }\n    } catch (err) {\n      console.error('guards import error', err)\n    }\n\n    // Additional checks (customer-only sections, etc.) can be added here\n    return NextResponse.next()\n  },\n  {\n    callbacks: {\n      authorized: ({ token }) => !!token\n    }\n  }\n)\n\nexport const config = { matcher: ['/admin/:path*', '/dashboard/:path*'] }\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;;;uCAMe,IAAA,mXAAQ,EACrB,SAAS,WAAW,GAAG;IACrB,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAI,OAAO;IAClC,MAAM,OAAO,OAAO,IAAI,QAAQ,EAAE,OAAO,QAAQ;IAE/C,aAAa;IACb,IAAI;QACF,MAAM,EAAE,OAAO,EAAE;QACjB,IAAI,SAAS,UAAU,CAAC,uBAAuB,CAAC,QAAQ,MAAM;YAAC;SAAc,GAAG;YAC9E,OAAO,iWAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAiB,IAAI,GAAG;QAC/D;QAEA,qBAAqB;QACrB,IAAI,SAAS,UAAU,CAAC,+BAA+B,CAAC,QAAQ,MAAM;YAAC;YAAe;SAAgB,GAAG;YACvG,OAAO,iWAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAiB,IAAI,GAAG;QAC/D;QAEA,yBAAyB;QACzB,IAAI,SAAS,UAAU,CAAC,mCAAmC,CAAC,QAAQ,MAAM;YAAC;YAAe;SAAqB,GAAG;YAChH,OAAO,iWAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAiB,IAAI,GAAG;QAC/D;QAEA,yBAAyB;QACzB,IAAI,SAAS,UAAU,CAAC,mCAAmC,CAAC,QAAQ,MAAM;YAAC;YAAe;SAAU,GAAG;YACrG,OAAO,iWAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAiB,IAAI,GAAG;QAC/D;IACF,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,uBAAuB;IACvC;IAEA,qEAAqE;IACrE,OAAO,iWAAY,CAAC,IAAI;AAC1B,GACA;IACE,WAAW;QACT,YAAY,CAAC,EAAE,KAAK,EAAE,GAAK,CAAC,CAAC;IAC/B;AACF;AAGK,MAAM,SAAS;IAAE,SAAS;QAAC;QAAiB;KAAoB;AAAC"}}]
}